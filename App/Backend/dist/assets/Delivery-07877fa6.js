import{r as h,R as M,a as R,S as B,C as O,j as a,s as I,N as G,b as k,A as F,O as Q,u as U,P as q,g as H}from"./index-4b586895.js";import{u as P}from"./useCart-44eb4b85.js";import{l as V,c as L,g as Y}from"./index-932f3582.js";import{L as W}from"./LoaderComponent-82f5dfb4.js";import{M as K}from"./Modal-0f89fbfb.js";var T={};Object.defineProperty(T,"__esModule",{value:!0});var N=T.loadMercadoPago=void 0;const D="https://sdk.mercadopago.com/js/v2",X=/^https:\/\/sdk\.mercadopago\.com\/js\/v2\/?(\?.*)?$/,C="MercadoPago has already been initialized in your window, please remove the duplicate import",J="MercadoPago.js not available",z="Failed to load MercadoPago.js",Z=()=>{for(var i=document.querySelectorAll(`script[src^="${D}"`),c=0;c<i.length;c++){var t=i[c];if(X.test(t.src))return t}return null},$=()=>{const i=document.createElement("script");i.src=D;const c=document.head||document.body;if(!c)throw new Error("Expected document.body or document.head not to be null. MercadoPago requires a <body> or a <head> element, please add on your project.");return c.appendChild(i),i};let S=null;const ee=()=>(S!==null||(S=new Promise((i,c)=>{if(typeof window>"u"){i(null);return}if(window.MercadoPago){console.warn(C),i(window.MercadoPago);return}try{let t=Z();t?console.warn(C):t||(t=$()),t.addEventListener("load",()=>{window.MercadoPago?i(window.MercadoPago):c(new Error(J))}),t.addEventListener("error",()=>{c(new Error(z))})}catch(t){c(t);return}})),S);N=T.loadMercadoPago=ee;var te=globalThis&&globalThis.__awaiter||function(i,c,t,o){function d(n){return n instanceof t?n:new t(function(r){r(n)})}return new(t||(t=Promise))(function(n,r){function f(e){try{s(o.next(e))}catch(l){r(l)}}function u(e){try{s(o.throw(e))}catch(l){r(l)}}function s(e){e.done?n(e.value):d(e.value).then(f,u)}s((o=o.apply(i,c||[])).next())})};class g{static getInstance(){return te(this,void 0,void 0,function*(){if(this.publicKey)return this.loadedInstanceMercadoPago||(yield N(),this.loadedInstanceMercadoPago=!0),this.instanceMercadoPago||(this.instanceMercadoPago=new window.MercadoPago(this.publicKey,this.options)),this.instanceMercadoPago;console.error("Expected the PUBLIC_KEY to render the MercadoPago SDK React")})}}g.publicKey=null;g.options={};g.instanceMercadoPago=void 0;g.loadedInstanceMercadoPago=!1;function ne(i,c){return Object.keys(i).length===Object.keys(c).length&&Object.keys(i).every(o=>Object.prototype.hasOwnProperty.call(c,o)&&i[o]===c[o])}const oe=(i,c)=>{const t=Object.assign(Object.assign({},c),{frontEndStack:"react"}),o=!ne(g.options,t);(i!==g.publicKey||o)&&(g.publicKey=i,g.options=t,g.instanceMercadoPago=void 0)},ae=200;var re=globalThis&&globalThis.__awaiter||function(i,c,t,o){function d(n){return n instanceof t?n:new t(function(r){r(n)})}return new(t||(t=Promise))(function(n,r){function f(e){try{s(o.next(e))}catch(l){r(l)}}function u(e){try{s(o.throw(e))}catch(l){r(l)}}function s(e){e.done?n(e.value):d(e.value).then(f,u)}s((o=o.apply(i,c||[])).next())})};const ie=()=>re(void 0,void 0,void 0,function*(){}),se=()=>{},ce=i=>{console.error(i)};var le=globalThis&&globalThis.__awaiter||function(i,c,t,o){function d(n){return n instanceof t?n:new t(function(r){r(n)})}return new(t||(t=Promise))(function(n,r){function f(e){try{s(o.next(e))}catch(l){r(l)}}function u(e){try{s(o.throw(e))}catch(l){r(l)}}function s(e){e.done?n(e.value):d(e.value).then(f,u)}s((o=o.apply(i,c||[])).next())})};const de=({settings:i,name:c,divId:t,controller:o})=>le(void 0,void 0,void 0,function*(){const d=yield g.getInstance(),n=d==null?void 0:d.bricks();window[o]=yield n==null?void 0:n.create(c,t,i)}),ue=({onReady:i=se,onError:c=ce,onSubmit:t=ie,customization:o,initialization:d,locale:n})=>(h.useEffect(()=>{let r;const f={settings:{initialization:d,customization:o,locale:n,callbacks:{onReady:i,onSubmit:t,onError:c}},name:"wallet",divId:"walletBrick_container",controller:"walletBrickController"};return r=setTimeout(()=>{de(f)},ae),()=>{var u;clearTimeout(r),(u=window.walletBrickController)===null||u===void 0||u.unmount()}},[o,d,i,c,t]),M.createElement("div",{id:"walletBrick_container"}));globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__awaiter;async function fe(i,c,t,o,d,n){try{return await R.post(`${B}/create_preference`,{items:i,address:c,extra:{tipoPago:t,tipoEntrega:o,notaPedido:d,user_id:n}},{headers:{"Content-Type":"application/json"}})}catch(r){throw console.error("Error al realizar la solicitud a Mercado Pago:",r),new O}}const me="data:image/webp;base64,UklGRvQAAABXRUJQVlA4WAoAAAAQAAAAHQAAHQAAQUxQSJkAAAABkBCAbRg2ghIogWImgiIohiIo3vZHSRlExAQgXGyP3dp4yEnNmz23ZsR5yKDnqQ6cx/zPnuf1j98ZQE1MRVOAIwEdGTU3imbrG/Y37ZMlFVCS+uQ5CnHfdabD+DAtqYCS1HN0n/4VoImb32h/s5ejBjoDKhpx4gKWo1sAqHf7H/AV8X++aZz5gkjLN97IF52YuF+L7bGbGyEAVlA4IDQAAAAwAwCdASoeAB4APxF4s1IsJySisBgIAYAiCWIAyNQYTVHAAP7wakt6paUE4s2QbCb1lAAA",pe="data:image/webp;base64,UklGRsAAAABXRUJQVlA4WAoAAAAQAAAAEwAAEwAAQUxQSFoAAAABYAhJkqRGWZRBGZNGGZRDaZT75kOIiAlASuqWwtE03aVY8G4z4T0kALvHDmgm+L1osXFpQ3ca+B8OThrJrWSoayNsw881E+AzA8AJAeCwR+SuSob6eOiWSKRWUDggQAAAAHADAJ0BKhQAFAA+6W6vUikmJCKoCAEgHQllAL9xwFkADdxwAAD+8USVIyDev6A76NpWwvHHhg5avxgpa43QAAA=";function he({id:i,nombre:c,preciogrande:t,preciochico:o,descripcion:d,quantity:n,priceSelected:r,addToCart:f,removeProductFromCart:u}){let s;const{setPriceSelected:e}=P(),l=h.useId(),_=y=>{s=y.target.value,e(i,s==="Grande"?t:o,s==="Grande"?3:1)};return a.jsxs("div",{className:"order__item",children:[a.jsxs("div",{className:"order__item-r1",children:[a.jsx("p",{className:"order__name",children:c.toUpperCase()}),a.jsxs("select",{value:r==t?"Grande":"Chico",onChange:_,name:l,id:l,className:"order__item-selectsize",children:[t!=0&&a.jsx("option",{value:"Grande",disabled:t==0,children:"Grande"}),o!=0&&a.jsx("option",{value:"Chico",disabled:o==0,children:"Chico"})]}),a.jsx("p",{className:"order__price",children:`$${r*n}`})]}),a.jsxs("div",{className:"order__item-r2",children:[a.jsx("p",{className:"order__desc",children:d.toUpperCase()}),a.jsxs("div",{className:"order__buttons",children:[a.jsx("img",{src:me,alt:"Sumar Item",onClick:f}),a.jsx("p",{children:n}),a.jsx("img",{src:pe,alt:"Restar item",onClick:u})]})]})]})}function Ae(){return a.jsxs(we,{children:[a.jsx(ge,{children:" El carrito está vacio"}),a.jsx(be,{to:"/carta",children:a.jsx(xe,{className:"button",children:"Ver Carta"})})]})}const we=I.div`
    width: 100%;
    display:flex;
    flex-direction: column;
    justify-content: center;
    gap: 1rem;
    padding: 1rem;
`,ge=I.p`
    text-align: center;
`,be=I(G)`
    width: 100%;
    display: flex;
    justify-content: center;
`,xe=I.button`
    display: flex;
    width: fit-content;
    height: 2rem;
    padding: 0.5rem 1rem;
    justify-content: center;
    align-items: center;
    border-radius: 2rem;
    text-align: center;
    font-size: 0.8125rem;
    font-family: 'Amiri';
    font-weight: 400;
    line-height: 1.5rem;
    letter-spacing: 0.00163rem;
    text-transform: uppercase;
    border: none;
    background-color: var(--gray-1);

    &:hover{
    cursor: pointer;
    transform: scale(1.1);
    background-color: var(--gray-3);
}
`;function ye({onSubmit:i,total:c,preferenceId:t,isOrderedEft:o,loading:d}){var v,E,m,p,w;const n=h.useId(),r=h.useId(),f=h.useId(),u=h.useId(),s=h.useId(),{register:e,watch:l,formState:_,handleSubmit:y,reset:j}=k({mode:"onTouched"}),{errors:A}=_;return h.useEffect(()=>{o.isSubmitted&&j()},[o.isSubmitted,j]),a.jsxs("form",{className:"form-container",onSubmit:y(i),children:[a.jsxs("div",{className:"order__note-container",children:[a.jsx("label",{htmlFor:s,children:"Nota de pedido"}),a.jsx("textarea",{name:s,id:s,cols:"30",rows:"5",placeholder:"Por ej: quiero la hamburguesa sin lechuga y las papas sin panceta",...e("notaPedido")})]}),a.jsxs("div",{className:"order__form",children:[a.jsxs("div",{className:"form__row",children:[a.jsx("label",{htmlFor:u,children:"Tipo Entrega"}),a.jsxs("select",{name:u,id:u,...e("tipoEntrega",{required:"Debes incluir como sera entregado"}),children:[a.jsx("option",{value:"1",children:"Delivery"}),a.jsx("option",{value:"2",children:"Retirar en el local"})]})]}),a.jsxs("div",{className:"form__row",children:[a.jsx("label",{htmlFor:n,children:"Direccion"}),a.jsxs("div",{children:[a.jsx("input",{type:"text",id:n,...e("direccionCliente",{required:"Debes incluir la direccion",disabled:l("tipoEntrega")!=="1",pattern:F})}),((v=A.direccionCliente)==null?void 0:v.type)==="pattern"&&a.jsx("p",{role:"alert",className:"form-error input-error",children:"Algunos caracteres no estan permitidos"}),((E=A.direccionCliente)==null?void 0:E.type)==="required"&&a.jsx("p",{role:"alert",className:"form-error input-error",children:A.direccionCliente.message})]})]}),a.jsxs("div",{className:"form__row",children:[a.jsx("label",{htmlFor:r,children:"Tipo Pago"}),a.jsxs("select",{name:r,id:r,...e("tipoPago",{required:"Debes incluir como pagar tu pedido"}),children:[a.jsx("option",{value:"1",children:"Efectivo"}),a.jsx("option",{value:"2",children:"Transferencia"})]})]}),a.jsxs("div",{className:"form__row",children:[a.jsx("label",{htmlFor:f,children:"Abono con"}),a.jsxs("div",{children:[a.jsx("input",{type:"text",id:f,...e("montoEft",{required:"Debes incluir con cuanto efectivo nos pagas.",disabled:l("tipoPago")==="2",pattern:{value:Q,message:"Solo se permiten números"},validate:b=>{const x=parseFloat(b);return x>=c&&x<=x*2?"El monto no puede ser tan grande":"El monto a pagar debe ser superior al total"}})}),((m=A.montoEft)==null?void 0:m.type)==="required"&&a.jsx("p",{role:"alert",className:"form-error input-error",children:A.montoEft.message}),((p=A.montoEft)==null?void 0:p.type)==="pattern"&&a.jsx("p",{role:"alert",className:"form-error input-error",children:A.montoEft.message}),((w=A.montoEft)==null?void 0:w.type)==="validate"&&a.jsx("p",{role:"alert",className:"form-error input-error",children:A.montoEft.message})]})]})]}),a.jsxs("div",{className:"order__button",children:[a.jsx("button",{type:"submit",className:"order__confirmar button",disabled:c==0,children:d?a.jsx(W,{size:"small",color:"mp-color"}):"Confirmar pedido"}),t&&l("tipoPago")==="2"&&a.jsx(ue,{initialization:{preferenceId:t,redirectMode:"modal"},className:"button mp_button"})]})]})}const _e="data:image/webp;base64,UklGRh4DAABXRUJQVlA4WAoAAAAQAAAAfwAAfwAAQUxQSLICAAABGTJp2xDb20T0P9iqfh6QNNu2aT37i23bdlpfunbST9Pmn0jPTrpu2Wzatnn57Hc+3O9crH2eqr6qiAlw4DaSIrl3e2+5jukHlDTGqPGWm26QtlzFfHXDUS8poqUdpvEaKOegrdKUGM/wk+mWuVQYdvIXaq8NFNijmj85E73C3nJ+Y+2wFXsz+PXSeOwN4FdEB+y100AVV4IkjzJVcmuuvyGGGGuMIQaRXU/PZfnstVc+++yNOEb6GGOIIYYYa4jA0/7xymefffbaWzlQndXf0EOMRqCV8cNn9XfDV3mBH6/+Ph6OMKqUX+ofC6/9FhgTYVfBPyfLVqRgqkIqARXTRlICSUpISiA+T5CQxJZmoFY6CyphQLdPXErwAkwY0O3z2FSB07G7GwFBiw0dKbwzFb/FtozmWMmxBU8w9MJrTR74nvphi2vIdNuN5OHrzCHHvUTGWWqllhz85dSBnyk/TGIi5Ixqz/Tn5pf5niGE3LPRJBf0VT96yimFbVuYHF+otznN7bJjJIQ8tcBdLdXxl1MDdg1x1FXExSF1Y4PhiPXqeMopA55JcQpzc4w0guuPX05JhE1rw+Oz9jXpr30ek7fFR1vEmyhpBP78F0u6YBW+poM0oQojAkSWrTPJb70o7UiEZBDMLKOmAX1UUp6mmNCRwry4DJjBv+6pf6BCLy6OjwSBgCZ8aAiITnmawqGF5jBaIAyAJ23h6fjQqdqKwEzxaDq8duBvuyi2DC4tKwpFMKDB5wnRoUnnYSvYNOVp1FfCLUa/7hWQmRJuN4EHwYKTZePBBv23DEw2j1/RguCJ4OQnEQiTyHz8p7x3eHgN6Q4ZRcM/8gAHd2FDb5DVDFzWVlj3rHFYFTBhNQKuoxY7qgeof1Yg8DpvqGWWGK2HKpjt/3vtjAsIg4rahTRqLwJWUDggRgAAAHAGAJ0BKoAAgAA+kUihTKWkIyIgiACwEglpbuF0kABPbYi8QVHPbEXiCo57Yi8QVHPbEXiCo57Yi8QTYAD+/1JPYoAAAAA=",je=V("/");function Ce(){oe("APP_USR-aaad6c69-62aa-4d6b-a9fd-e744881e088a");const[i,c]=h.useState(0),[t,o]=h.useState(null),[d,n]=h.useState({isSubmitted:!1,goodStatus:!1}),[r,f]=h.useState(!1),{auth:u}=U(),{cart:s,clearCart:e,addToCart:l,removeProductFromCart:_,modifyCart:y}=P();h.useEffect(()=>{new URLSearchParams(window.location.search).get("collection_status")&&e()},[]),h.useEffect(()=>{(()=>{const p=s.reduce((w,b)=>w+b.priceSelected*b.quantity,0);c(p)})()},[s]);function j(){n({isSubmitted:!1,goodStatus:!1})}async function A({direccionCliente:m,tipoPago:p,tipoEntrega:w,notaPedido:b}){try{return await fe(y(s),m,p,w,b,u.data.user_id)}catch(x){return x}}const v=async m=>{if(m.tipoPago=="2")try{const w=(await A(m)).data.response.id;w&&o(w)}catch{n({isSubmitted:!0,goodStatus:!1})}else try{const p=new Date,w=p.toISOString(),b=await L(w,u.data.user_id,m.direccionCliente,m.notaPedido,parseInt(m.total),parseInt(m.tipoPago),parseInt(m.tipoEntrega),parseInt(m.montoEft),y(s));if(b.status>=200&&b.status<300){const x=await Y({date:p});je.emit("newOrder",x.data.data[0]),n({isSubmitted:!0,goodStatus:!0}),e()}}catch(p){n({isSubmitted:!0,goodStatus:!1}),console.log(p)}f(!1)},E=m=>{f(!0);const p={...m,carritoItems:s,total:i};v(p)};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"delivery__container",children:[a.jsx(q,{pathPrev:"Home",pathActual:"Delivery",goTo:"Home"}),a.jsxs("div",{className:"order__container",children:[a.jsx("div",{className:"order__items",children:s.length===0?a.jsx(Ae,{}):s.map(m=>a.jsx(he,{...m,addToCart:()=>l(m),removeProductFromCart:()=>_(m)},H()))}),a.jsxs("div",{className:"order__total",children:[a.jsx("p",{className:"order__total-name",children:"TOTAL"}),a.jsx("p",{className:"order__total-price",children:`$${i}`})]}),a.jsx("div",{className:"order__button",children:a.jsx("button",{className:"button delete_cart_button",onClick:e,children:a.jsx("img",{src:_e,alt:"Trash Button"})})})]}),a.jsx(ye,{onSubmit:E,total:i,preferenceId:t,isOrderedEft:d,loading:r}),d.isSubmitted&&a.jsx(K,{isSubmitted:d.isSubmitted,handleSubmit:j,isGoodStatus:d.goodStatus,position:"top",msg:d.goodStatus?"Tu pedido ha sido realizado correctamente!":"Tu pedido no pudo ser procesado, intente nuevamente!"})]})})}export{Ce as default};
