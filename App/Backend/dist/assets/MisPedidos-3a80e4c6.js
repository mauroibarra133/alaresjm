import{r as a,j as e,u as L,P as A}from"./index-d654d3f8.js";import{e as z}from"./eye-slash-d3ee0e19.js";import{F as v}from"./FormVacio-0ff088d2.js";import{l as M,g as k}from"./index-2c7dcbac.js";import{t as g,f as D,h as N}from"./functions-63fd6aa2.js";import{L as F}from"./LoaderComponent-d1f3c2e2.js";function O({pedido:i}){const r=g(i.fecha),h=`${r.substring(8,10)}/${r.substring(5,7)}`,[c,o]=a.useState(window.innerWidth>768);return a.useEffect(()=>{const n=()=>{o(window.innerWidth>768)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),e.jsxs("div",{className:"datos__body-row",children:[e.jsx("div",{className:"datos__body-dato",children:h}),e.jsx("div",{className:"datos__body-dato",children:i.nombres_productos}),e.jsx("div",{className:"datos__body-dato datos__body-comensales",children:`$${i.total}`}),e.jsxs("div",{className:"datos__body-dato pedidos-estado",children:[e.jsx("img",{src:D(N(i.estado_pedido)),alt:i.estado_pedido,className:"status-img"}),c&&e.jsx("p",{children:N(i.estado_pedido)})]}),e.jsx("div",{className:"datos__body-dato"})]},i.id)}const P=M("/");function H(){const[i,r]=a.useState(!0),[h,c]=a.useState(!0),[o,n]=a.useState([]),[l,x]=a.useState(!1),[d,y]=a.useState(1),[j,b]=a.useState(0),[f,w]=a.useState([]),{auth:_}=L(),p=6,E={timeZone:"America/Argentina/Buenos_Aires"},S=new Date().toLocaleString("en-US",E).split(" ")[0];a.useEffect(()=>{document.title="Alares | Mis Pedidos "},[]),a.useEffect(()=>{const s=[];for(let t=1;t<=Math.ceil((u().length==0?1:u().length)/p);t++)s.push(t);w(s),m(1)},[o,i]),a.useEffect(()=>{async function s(){if(_.data.user_id){const t=await k({user_id:_.data.user_id});n(t.data.data)}}s().then(()=>c(!1)).catch(t=>{console.log(t),c(!1)})},[_.data.user_id]),a.useEffect(()=>{P.on("connect",()=>{P.on("pedidoActualizado",s=>{x(s)})})}),a.useEffect(()=>{if(l){const s=o.map(t=>t.id===l.id?{...t,estado_pedido:l.estado_pedido}:t);n(s),x(!1)}},[l]);function m(s){s!==d&&(window.scrollTo(0,10),y(s),b((s-1)*p))}function u(){if(o.length<=0)return[];if(i){const s=o.filter(t=>{if(g(t.fecha)>=g(S))return t});return s.length<=0?[]:s}else return o}function I(){if(o.length<=0)return e.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"});{const s=u();return s.length<=0?e.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):s.slice(j,p+j).map(t=>e.jsx(O,{pedido:t},t.id))}}return e.jsxs("div",{className:"mispedidos__container",children:[e.jsx(A,{pathPrev:"Home",pathActual:"Mis Pedidos",goTo:"home"}),e.jsxs("div",{className:"mispedidos__form",children:[e.jsxs("div",{className:"mispedidos__filter",children:[e.jsx("img",{src:z,alt:"Icono de oculto"}),e.jsx("p",{onClick:()=>r(!i),children:i?"Mostrar pedidos antiguas":"Ocultar pedidos antiguas"})]}),e.jsxs("div",{className:"mispedidos__datos",children:[e.jsxs("div",{className:"datos__header",children:[e.jsx("p",{className:"datos__header-column",children:"Fecha"}),e.jsx("p",{className:"datos__header-column",children:"Desc. Pedido"}),e.jsx("p",{className:"datos__header-column",children:"Monto"}),e.jsx("p",{className:"datos__header-column",children:"Estado"})]}),e.jsx("div",{className:"datos__body",children:h?e.jsx(F,{size:"small",color:"orange"}):I()})]})]}),u().length>0&&e.jsx("div",{className:"button",children:"PEDIR"}),f.length>1&&e.jsx("div",{className:"mispedidos__paginacion-wrapper",children:e.jsxs("div",{className:"mispedidos__paginacion",children:[e.jsx("div",{className:"mispedidos__pagina--button",children:e.jsx("p",{onClick:()=>m(d-1==0?d:d-1),children:"Previo"})}),o&&f.map(s=>e.jsx("div",{className:"mispedidos__pagina",onClick:()=>m(s),children:e.jsx("p",{className:`${s==d?"active":""}`,children:s})},s)),e.jsx("div",{className:"mispedidos__pagina--button",children:e.jsx("p",{onClick:()=>m(d+1>f.length?d:d+1),children:"Siguiente"})})]})})]})}export{H as default};
