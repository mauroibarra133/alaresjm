import{r as a,j as s,u as L,P as A}from"./index-633287f1.js";import{e as z}from"./eye-slash-d3ee0e19.js";import{F as v}from"./FormVacio-ffa6129e.js";import{l as k,g as D}from"./index-cd0c2e9f.js";import{t as g,f as F,h as N}from"./functions-9fef4e17.js";import{L as M}from"./LoaderComponent-920f17d9.js";function O({pedido:i}){const r=g(i.fecha),h=`${r.substring(8,10)}/${r.substring(5,7)}`,[c,o]=a.useState(window.innerWidth>768);return a.useEffect(()=>{const n=()=>{o(window.innerWidth>768)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),s.jsxs("div",{className:"datos__body-row",children:[s.jsx("div",{className:"datos__body-dato",children:h}),s.jsx("div",{className:"datos__body-dato",children:i.nombres_productos}),s.jsx("div",{className:"datos__body-dato datos__body-comensales",children:`$${i.total}`}),s.jsxs("div",{className:"datos__body-dato pedidos-estado",children:[s.jsx("img",{src:F(N(i.estado_pedido)),alt:i.estado_pedido,className:"status-img"}),c&&s.jsx("p",{children:N(i.estado_pedido)})]}),s.jsx("div",{className:"datos__body-dato"})]},i.id)}const P=k("/");function H(){const[i,r]=a.useState(!0),[h,c]=a.useState(!0),[o,n]=a.useState([]),[l,x]=a.useState(!1),[d,y]=a.useState(1),[j,b]=a.useState(0),[_,w]=a.useState([]),{auth:f}=L(),p=6,S={timeZone:"America/Argentina/Buenos_Aires"},E=new Date().toLocaleString("en-US",S).split(" ")[0];a.useEffect(()=>{const e=[];for(let t=1;t<=Math.ceil((u().length==0?1:u().length)/p);t++)e.push(t);w(e),m(1)},[o,i]),a.useEffect(()=>{async function e(){if(f.data.user_id){const t=await D({user_id:f.data.user_id});n(t.data.data)}}e().then(()=>c(!1)).catch(t=>{console.log(t),c(!1)})},[f.data.user_id]),a.useEffect(()=>{P.on("connect",()=>{P.on("pedidoActualizado",e=>{x(e)})})}),a.useEffect(()=>{if(l){const e=o.map(t=>t.id===l.id?{...t,estado_pedido:l.estado_pedido}:t);n(e),x(!1)}},[l]);function m(e){e!==d&&(window.scrollTo(0,10),y(e),b((e-1)*p))}function u(){if(o.length<=0)return[];if(i){const e=o.filter(t=>{if(g(t.fecha)>=g(E))return t});return e.length<=0?[]:e}else return o}function I(){if(o.length<=0)return s.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"});{const e=u();return e.length<=0?s.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):e.slice(j,p+j).map(t=>s.jsx(O,{pedido:t},t.id))}}return s.jsxs("div",{className:"mispedidos__container",children:[s.jsx(A,{pathPrev:"Home",pathActual:"Mis Pedidos",goTo:"home"}),s.jsxs("div",{className:"mispedidos__form",children:[s.jsxs("div",{className:"mispedidos__filter",children:[s.jsx("img",{src:z,alt:"Icono de oculto"}),s.jsx("p",{onClick:()=>r(!i),children:i?"Mostrar pedidos antiguas":"Ocultar pedidos antiguas"})]}),s.jsxs("div",{className:"mispedidos__datos",children:[s.jsxs("div",{className:"datos__header",children:[s.jsx("p",{className:"datos__header-column",children:"Fecha"}),s.jsx("p",{className:"datos__header-column",children:"Desc. Pedido"}),s.jsx("p",{className:"datos__header-column",children:"Monto"}),s.jsx("p",{className:"datos__header-column",children:"Estado"})]}),s.jsx("div",{className:"datos__body",children:h?s.jsx(M,{size:"small",color:"orange"}):I()})]})]}),u().length>0&&s.jsx("div",{className:"button",children:"PEDIR"}),_.length>1&&s.jsx("div",{className:"mispedidos__paginacion-wrapper",children:s.jsxs("div",{className:"mispedidos__paginacion",children:[s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>m(d-1==0?d:d-1),children:"Previo"})}),o&&_.map(e=>s.jsx("div",{className:"mispedidos__pagina",onClick:()=>m(e),children:s.jsx("p",{className:`${e==d?"active":""}`,children:e})},e)),s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>m(d+1>_.length?d:d+1),children:"Siguiente"})})]})})]})}export{H as default};
