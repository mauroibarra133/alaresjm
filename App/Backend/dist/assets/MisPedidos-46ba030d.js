import{G as f,r as a,j as s,H as b,u as S,P as E}from"./index-9b424e26.js";import{e as I}from"./eye-slash-d3ee0e19.js";import{F as x}from"./FormVacio-eab223a8.js";import{l as O,g as k}from"./index-fa08e96a.js";function F({pedido:i}){const c=f(i.fecha),d=`${c.substring(8,10)}/${c.substring(5,7)}`,[l,n]=a.useState(window.innerWidth>768);return a.useEffect(()=>{const r=()=>{n(window.innerWidth>768)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),s.jsxs("div",{className:"datos__body-row",children:[s.jsx("div",{className:"datos__body-dato",children:d}),s.jsx("div",{className:"datos__body-dato",children:i.nombres_productos}),s.jsx("div",{className:"datos__body-dato datos__body-comensales",children:`$${i.total}`}),s.jsxs("div",{className:"datos__body-dato pedidos-estado",children:[s.jsx("img",{src:b(i.estado_pedido),alt:"",className:"status-img"}),l&&s.jsx("p",{children:i.estado_pedido})]}),s.jsx("div",{className:"datos__body-dato"})]},i.id)}const j=O("/");function A(){const[i,c]=a.useState(!0),[d,l]=a.useState([]),[n,r]=a.useState(!1),[o,v]=a.useState(1),[p,N]=a.useState(0),[g,P]=a.useState([]),{auth:h}=S(),_=6,y=new Date().toISOString().split("T")[0];a.useEffect(()=>{const e=[];for(let t=1;t<=Math.ceil((m().length==0?1:m().length)/_);t++)e.push(t);P(e),u(1)},[d,i]),a.useEffect(()=>{async function e(){if(h.data.user_id){const t=await k({user_id:h.data.user_id});l(t.data.data)}}e()},[h.data.user_id]),a.useEffect(()=>{j.on("connect",()=>{j.on("pedidoActualizado",e=>{r(e)})})}),a.useEffect(()=>{if(n){const e=d.map(t=>t.id===n.id?{...t,estado_pedido:n.estado_pedido}:t);console.log(e),l(e),r(!1)}},[n]);function u(e){e!==o&&(window.scrollTo(0,10),v(e),N((e-1)*_))}console.log(d);function m(){if(d.length<=0)return[];if(i){const e=d.filter(t=>{if(f(t.fecha)>=f(y))return t});return e.length<=0?[]:e}else return d}function w(){return d.length<=0?s.jsx(x,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):m().length<=0?s.jsx(x,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):m().slice(p,_+p).map(t=>s.jsx(F,{pedido:t},t.id))}return s.jsxs("div",{className:"mispedidos__container",children:[s.jsx(E,{pathPrev:"Home",pathActual:"Mis Pedidos",goTo:"home"}),s.jsxs("div",{className:"mispedidos__form",children:[s.jsxs("div",{className:"mispedidos__filter",children:[s.jsx("img",{src:I,alt:"Icono de oculto"}),s.jsx("p",{onClick:()=>c(!i),children:i?"Mostrar pedidos antiguas":"Ocultar pedidos antiguas"})]}),s.jsxs("div",{className:"mispedidos__datos",children:[s.jsxs("div",{className:"datos__header",children:[s.jsx("p",{className:"datos__header-column",children:"Fecha"}),s.jsx("p",{className:"datos__header-column",children:"Desc. Pedido"}),s.jsx("p",{className:"datos__header-column",children:"Monto"}),s.jsx("p",{className:"datos__header-column",children:"Estado"})]}),s.jsx("div",{className:"datos__body",children:w()})]})]}),s.jsx("div",{className:"mispedidos__paginacion-wrapper",children:s.jsxs("div",{className:"mispedidos__paginacion",children:[s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>u(o-1==0?o:o-1),children:"Previo"})}),d&&g.map(e=>s.jsx("div",{className:"mispedidos__pagina",onClick:()=>u(e),children:s.jsx("p",{className:`${e==o?"active":""}`,children:e})},e)),s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>u(o+1>g.length?o:o+1),children:"Siguiente"})})]})})]})}export{A as default};
