import{H as g,r as a,j as s,I as E,u as I,P as L}from"./index-a2ffd1f7.js";import{e as O}from"./eye-slash-d3ee0e19.js";import{F as v}from"./FormVacio-5cc54e9a.js";import{l as k,g as z}from"./index-b9ccc105.js";import{L as F}from"./LoaderComponent-2e6ae831.js";function M({pedido:i}){const r=g(i.fecha),u=`${r.substring(8,10)}/${r.substring(5,7)}`,[c,o]=a.useState(window.innerWidth>768);return a.useEffect(()=>{const n=()=>{o(window.innerWidth>768)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),s.jsxs("div",{className:"datos__body-row",children:[s.jsx("div",{className:"datos__body-dato",children:u}),s.jsx("div",{className:"datos__body-dato",children:i.nombres_productos}),s.jsx("div",{className:"datos__body-dato datos__body-comensales",children:`$${i.total}`}),s.jsxs("div",{className:"datos__body-dato pedidos-estado",children:[s.jsx("img",{src:E(i.estado_pedido),alt:i.estado_pedido,className:"status-img"}),c&&s.jsx("p",{children:i.estado_pedido})]}),s.jsx("div",{className:"datos__body-dato"})]},i.id)}const N=k("/");function $(){const[i,r]=a.useState(!0),[u,c]=a.useState(!0),[o,n]=a.useState([]),[l,x]=a.useState(!1),[d,P]=a.useState(1),[j,y]=a.useState(0),[h,w]=a.useState([]),{auth:_}=I(),f=6,S=new Date().toISOString().split("T")[0];a.useEffect(()=>{const e=[];for(let t=1;t<=Math.ceil((p().length==0?1:p().length)/f);t++)e.push(t);w(e),m(1)},[o,i]),a.useEffect(()=>{async function e(){if(_.data.user_id){const t=await z({user_id:_.data.user_id});n(t.data.data)}}e().then(()=>c(!1)).catch(t=>{console.log(t),c(!1)})},[_.data.user_id]),a.useEffect(()=>{N.on("connect",()=>{N.on("pedidoActualizado",e=>{x(e)})})}),a.useEffect(()=>{if(l){const e=o.map(t=>t.id===l.id?{...t,estado_pedido:l.estado_pedido}:t);n(e),x(!1)}},[l]);function m(e){e!==d&&(window.scrollTo(0,10),P(e),y((e-1)*f))}function p(){if(o.length<=0)return[];if(i){const e=o.filter(t=>{if(g(t.fecha)>=g(S))return t});return e.length<=0?[]:e}else return o}function b(){if(o.length<=0)return s.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"});{const e=p();return e.length<=0?s.jsx(v,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):e.slice(j,f+j).map(t=>s.jsx(M,{pedido:t},t.id))}}return s.jsxs("div",{className:"mispedidos__container",children:[s.jsx(L,{pathPrev:"Home",pathActual:"Mis Pedidos",goTo:"home"}),s.jsxs("div",{className:"mispedidos__form",children:[s.jsxs("div",{className:"mispedidos__filter",children:[s.jsx("img",{src:O,alt:"Icono de oculto"}),s.jsx("p",{onClick:()=>r(!i),children:i?"Mostrar pedidos antiguas":"Ocultar pedidos antiguas"})]}),s.jsxs("div",{className:"mispedidos__datos",children:[s.jsxs("div",{className:"datos__header",children:[s.jsx("p",{className:"datos__header-column",children:"Fecha"}),s.jsx("p",{className:"datos__header-column",children:"Desc. Pedido"}),s.jsx("p",{className:"datos__header-column",children:"Monto"}),s.jsx("p",{className:"datos__header-column",children:"Estado"})]}),s.jsx("div",{className:"datos__body",children:u?s.jsx(F,{size:"small",color:"orange"}):b()})]})]}),h.length>1&&s.jsx("div",{className:"mispedidos__paginacion-wrapper",children:s.jsxs("div",{className:"mispedidos__paginacion",children:[s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>m(d-1==0?d:d-1),children:"Previo"})}),o&&h.map(e=>s.jsx("div",{className:"mispedidos__pagina",onClick:()=>m(e),children:s.jsx("p",{className:`${e==d?"active":""}`,children:e})},e)),s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>m(d+1>h.length?d:d+1),children:"Siguiente"})})]})})]})}export{$ as default};
