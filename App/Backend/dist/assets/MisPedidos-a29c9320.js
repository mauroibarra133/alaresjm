import{H as p,r as i,j as s,I as b,u as S,P as E}from"./index-39b704a7.js";import{e as I}from"./eye-slash-d3ee0e19.js";import{F as x}from"./FormVacio-fe129911.js";import{l as O,g as k}from"./index-d19ecde4.js";function F({pedido:a}){const c=p(a.fecha),d=`${c.substring(8,10)}/${c.substring(5,7)}`,[l,n]=i.useState(window.innerWidth>768);return i.useEffect(()=>{const r=()=>{n(window.innerWidth>768)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),s.jsxs("div",{className:"datos__body-row",children:[s.jsx("div",{className:"datos__body-dato",children:d}),s.jsx("div",{className:"datos__body-dato",children:a.nombres_productos}),s.jsx("div",{className:"datos__body-dato datos__body-comensales",children:`$${a.total}`}),s.jsxs("div",{className:"datos__body-dato pedidos-estado",children:[s.jsx("img",{src:b(a.estado_pedido),alt:a.estado_pedido,className:"status-img"}),l&&s.jsx("p",{children:a.estado_pedido})]}),s.jsx("div",{className:"datos__body-dato"})]},a.id)}const j=O("/");function A(){const[a,c]=i.useState(!0),[d,l]=i.useState([]),[n,r]=i.useState(!1),[o,v]=i.useState(1),[g,N]=i.useState(0),[h,P]=i.useState([]),{auth:_}=S(),f=6,y=new Date().toISOString().split("T")[0];i.useEffect(()=>{const e=[];for(let t=1;t<=Math.ceil((m().length==0?1:m().length)/f);t++)e.push(t);P(e),u(1)},[d,a]),i.useEffect(()=>{async function e(){if(_.data.user_id){const t=await k({user_id:_.data.user_id});l(t.data.data)}}e()},[_.data.user_id]),i.useEffect(()=>{j.on("connect",()=>{j.on("pedidoActualizado",e=>{r(e)})})}),i.useEffect(()=>{if(n){const e=d.map(t=>t.id===n.id?{...t,estado_pedido:n.estado_pedido}:t);l(e),r(!1)}},[n]);function u(e){e!==o&&(window.scrollTo(0,10),v(e),N((e-1)*f))}function m(){if(d.length<=0)return[];if(a){const e=d.filter(t=>{if(p(t.fecha)>=p(y))return t});return e.length<=0?[]:e}else return d}function w(){return d.length<=0?s.jsx(x,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):m().length<=0?s.jsx(x,{goTo:"delivery",msg:"Aun no tienes ningun pedido hoy",msgButton:"PEDIR"}):m().slice(g,f+g).map(t=>s.jsx(F,{pedido:t},t.id))}return s.jsxs("div",{className:"mispedidos__container",children:[s.jsx(E,{pathPrev:"Home",pathActual:"Mis Pedidos",goTo:"home"}),s.jsxs("div",{className:"mispedidos__form",children:[s.jsxs("div",{className:"mispedidos__filter",children:[s.jsx("img",{src:I,alt:"Icono de oculto"}),s.jsx("p",{onClick:()=>c(!a),children:a?"Mostrar pedidos antiguas":"Ocultar pedidos antiguas"})]}),s.jsxs("div",{className:"mispedidos__datos",children:[s.jsxs("div",{className:"datos__header",children:[s.jsx("p",{className:"datos__header-column",children:"Fecha"}),s.jsx("p",{className:"datos__header-column",children:"Desc. Pedido"}),s.jsx("p",{className:"datos__header-column",children:"Monto"}),s.jsx("p",{className:"datos__header-column",children:"Estado"})]}),s.jsx("div",{className:"datos__body",children:w()})]})]}),h.length>1&&s.jsx("div",{className:"mispedidos__paginacion-wrapper",children:s.jsxs("div",{className:"mispedidos__paginacion",children:[s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>u(o-1==0?o:o-1),children:"Previo"})}),d&&h.map(e=>s.jsx("div",{className:"mispedidos__pagina",onClick:()=>u(e),children:s.jsx("p",{className:`${e==o?"active":""}`,children:e})},e)),s.jsx("div",{className:"mispedidos__pagina--button",children:s.jsx("p",{onClick:()=>u(o+1>h.length?o:o+1),children:"Siguiente"})})]})})]})}export{A as default};
